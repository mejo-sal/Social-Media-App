{% extends "base.html" %}
{% block content %}
<h2>{{ post.author.username }}</h2>
<p>{{ post.content }}</p>
{% if post.image %}
    <img src="{{ post.image.url }}" style="max-width:300px;">
{% endif %}
<p>{{ post.likes_count }} Likes | {{ post.comments_count }} Comments</p>

<form action="{% url 'posts:like_post' post.id %}" method="post">
    {% csrf_token %}
    <button type="submit">
        {% if user in post.likes.all %}
            Unlike
        {% else %}
            Like
        {% endif %}
    </button>
</form>

<hr>
<h3>Comments</h3>
{% for comment in post.comments.all %}
    <p><strong>{{ comment.author.username }}</strong>: {{ comment.content }}</p>
{% empty %}
    <p>No comments yet.</p>
{% endfor %}

<form action="{% url 'posts:add_comment' post.id %}" method="post">
    {% csrf_token %}
    {{ comment_form.as_p }}
    <button type="submit">Add Comment</button>
</form>
{% endblock %}
